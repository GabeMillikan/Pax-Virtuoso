import random

from abilities.music.youtube import *

song = asyncio.run(fetch("anti up chromatic"))

bytes_produces = 0
packet_count = 0
while packet := song.stream.read():
    packet_count += 1
    bytes_produces += len(packet)

    song.stream.volume = random.random() + 0.5

print("Data size:", bytes_produces, "bytes across", packet_count, "packets")

# from opuslib import Decoder

# p = bytes.fromhex(
#     "4F 70 75 73 48 65 61 64 01 02 38 01 80 BB 00 00 00 00 00 "
#     # "4F 70 75 73 54 61 67 73 0C 00 00 00 4C 61 76 66 36 30 2E 33 2E 31 30 30 02 00 00 00 0C 00 00 00 6C 61 6E 67 75 61 67 65 3D 65 6E 67 1C 00 00 00 65 6E 63 6F 64 65 72 3D 4C 61 76 63 36 30 2E 33 2E 31 30 30 20 6C 69 62 6F 70 75 73 "
#     # "FC FF FE "
#     # "FC 7F BC 0E BF E0 18 6C 00 B0 F9 1C A0 B6 47 E3 A3 3D 18 B3 F8 0B 01 32 BC 72 BE C0 05 7D DB 1C 83 8C 75 58 82 67 24 C9 71 B5 46 14 92 29 D7 B6 2B A4 59 B4 85 F5 E5 E2 A9 45 AD 07 80 26 0F D1 14 14 5B AA 25 FD CD C1 0D D8 8F 34 6A 84 61 32 35 84 90 3C 28 26 AA 38 17 C0 80 1C BD 4C FC E5 DA 19 65 C7 15 C0 1E 0B F4 CE 58 C7 67 5E 6A F2 9D EB 1B 25 15 3A D3 80 57 EE B2 13 DC 2E 0A 1C 72 0C 4F 74 D6 F2 D3 CD 76 45 83 8D 07 19 B9 6A 31 0C D0 AE 9C 82 B8 0A 28 6D FF D1 C0 7D 38 AF CB 87 EF 0F 76 4A 77 D7 0C 0A 1C 8A 82 60 B9 D4 FD 60 59 BC 83 04 8A D8 BC 33 D3 39 FE 33 3B 3E 58 36 2C F9 69 CC 12 D4 E3 12 7E DF 33 01 25 CC C7 53 88 4F 31 5F 24 9F CC A0 60 42 39 79 F0 7C D0 DD 3B 00 00 00 00 00 00 00 00 4B C7 33 6B 3A 97 DA 14 93 D8 65 9C B5 70 FA 07 07 F4 6E 17 05 BA A6 9B FF F9 1E 1E 69 D9 18 C6 0A 2A 60 0B FB 89 BE 4A 0E E5 CB C5 68 52 BE F3 A7 05 D3 C9 2B A7 91 60 17 32 56 13 B5 C6 E6 69 00 44 21 82 18 0D 81 B8 7E 19 C1 21 7E 5D B9 F0 C0 34 47 50 AE 41 0F FB 8B C0 1F F4 A8 3C E7 60 87 50 71 63 55 CB E6 08 A7 DB 27 43 1F EE 8E 36 A8 57 A1 5F 7A 7B 63 CB CD F8 AF 8C FD A3 3D 80 40 AC AA 6A 29 3B 56 10 81 1A 70 F0 1D 73 79 A4 43 6C A6 A3 6B 42 DB AB EB 93 92 AA 8C 10 D8 90 F2 9B 01 F0 22 F2 D9 D5 14 5B 72 79 EB BC 9F C3 36 BF 9F 23 AF 93 D9 DD C1 B2 C7 40 06 29 43 54 16 92 94 9F 82 B5 41 FF 05 7D 59 41 AC 2A CA E6 69 04 B0 3F D8 5E 42 B1 92 F8 CB DA 35 36 41 D4 A8 E4 99 C9 FE BE C0 "
#     # "FC 43 8E 15 95 AD F6 BB B2 D4 F2 B3 F0 2D B2 BB EC B9 6B 13 5C 50 44 68 B6 3B B4 FA 04 A1 9D 17 67 BB BE 4A 7B 52 1D 13 4B 8A EF F9 48 1F D2 4D A4 CE B0 E8 C7 23 24 A3 72 65 52 3B 58 78 6B C2 D0 E6 B0 6B 06 C4 59 5A ED 74 E1 26 97 A5 04 E1 4B C1 E3 CA 76 8D 1C A0 0D 36 A8 37 36 D8 C2 F7 15 03 B7 1C C3 B8 82 B0 6B E1 C9 33 75 7B B7 E6 42 75 11 42 77 D9 27 01 7C 30 AF 48 1B 36 29 37 9E 48 D1 32 27 91 BC 45 B6 0F 7D A0 57 E9 C1 C2 DE 83 45 3D E1 3B BA 4E 03 6C 1A 26 43 F6 25 6A 70 BF 86 23 86 0E 5B 79 2E F5 5F 65 FF 20 4B 74 2E 09 2F 11 E6 1A 91 1B AC 23 2B BB 3F 15 8F 13 FF 8B 0D B7 73 B0 5A 46 FE 03 60 FB 6F 3D 4F 7E 86 3E A3 F3 27 02 F8 43 E7 4D 72 5E A1 8E 5F D6 4A 3C "
#     # "FC 1F 1E 98 DC F7 79 78 8F C0 CA D9 F2 C7 2C 8A 52 96 46 62 FF 39 30 8D 17 8C F6 65 C4 0A DA 43 E6 72 5A ED 85 2C C5 5E B9 0B 1D 4A C5 69 D2 39 FD A7 7D 72 43 67 D6 87 FE 7F AA 01 79 4C 01 F7 35 11 45 C9 3E 75 68 97 B2 4E CA 64 16 53 4B 59 96 72 FE C0 07 65 DC 2C 56 36 1E 13 29 50 FF 56 45 39 AF 56 93 45 D4 F3 98 04 2F 6F 1D FA 62 00 3D 33 E1 4D E8 2B DD C0 0F 70 1B BB 98 B2 34 B4 9A EE D3 17 FD 57 09 FC 54 46 35 7C 6F 47 ED EB 80 BE F0 69 B0 05 92 2C 40 41 77 88 94 C3 A7 CF A8 01 D0 65 D7 1E FC 69 12 4D C0 82 6F 82 06 BA 62 DC A6 0E 84 83 60 6A 7C 7A 14 40 1B E9 D0 2E 03 F1 A8 0E 98 C0 58 DB 08 1B 0D F8 ED 18 EC 8B A9 4A 4B AE FA 3A DA 3F C7 3F DE CC 66 1D FE 79 D0 "
# )

# SAMPLE_RATE = 48000  # hertz
# FRAME_DURATION = 20  # milliseconds
# FRAMES_PER_SECOND = 1000 // FRAME_DURATION
# SAMPLES_PER_FRAME = SAMPLE_RATE // FRAMES_PER_SECOND
# CHANNELS = 2
# SAMPLES_PER_CHANNEL_FRAME = SAMPLES_PER_FRAME // CHANNELS

# d = Decoder(SAMPLE_RATE, CHANNELS)
# d.decode(p, SAMPLES_PER_CHANNEL_FRAME)

# from opuslib import Decoder

# SAMPLE_RATE = 48000  # hertz
# FRAME_DURATION = 20  # milliseconds
# FRAMES_PER_SECOND = 1000 // FRAME_DURATION
# SAMPLES_PER_FRAME = SAMPLE_RATE // FRAMES_PER_SECOND
# CHANNELS = 2
# SAMPLES_PER_CHANNEL_FRAME = SAMPLES_PER_FRAME // CHANNELS

# packet = bytes.fromhex("4F 70 75 73 48 65 61 64 01 02 38 01 80 BB 00 00 00 00 00")

# decoder = Decoder(SAMPLE_RATE, CHANNELS)
# result = decoder.decode(packet, SAMPLES_PER_CHANNEL_FRAME)

# print(result)
